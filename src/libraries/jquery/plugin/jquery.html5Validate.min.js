(function(e,t){DBC2SBC=function(e){var t="",r,i;for(r=0;r<e.length;r++){i=e.charCodeAt(r);if(i>=65281&&i<=65373){t+=String.fromCharCode(e.charCodeAt(r)-65248)}else if(i==12288){t+=String.fromCharCode(e.charCodeAt(r)-12288+32)}else{t+=e.charAt(r)}}return t};var r=require("commonjs");e.remindLayer=function(){var t=e(window).width();var r=function(t){if(!t||!t.target)return;if(t.target.id!==e.remindLayer.id&&e(t.target).parents("#"+e.remindLayer.id).length===0){e.remindLayer.hide()}},i=function(t){if(!t||!t.target)return;if(t.target.tagName.toLowerCase()!=="body"){e.remindLayer.hide()}},a=function(){if(!e.remindLayer.display)return;var r=e(window).width();if(Math.abs(t-r)>20){e.remindLayer.hide();t=r}};return{id:"validateRemind",display:false,css:{},hide:function(){e("#"+this.id).remove();this.display=false;if(this.target)this.target.removeClass("error");e(document).unbind({mousedown:r,keydown:i});e(window).unbind("resize",a)},bind:function(){e(document).bind({mousedown:r,keydown:i});e(window).bind("resize",a)}}}();OBJREG={EMAIL:"^[a-z0-9._%-]+@([a-z0-9-]+\\.)+[a-z]{2,4}$",NUMBER:"^\\-?\\d+(\\.\\d+)?$",URL:"^(http|https|ftp)\\:\\/\\/[a-z0-9\\-\\.]+\\.[a-z]{2,3}(:[a-z0-9]*)?\\/?([a-z0-9\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$",TEL:"^1\\d{10}$",ZIPCODE:"^\\d{6}$",prompt:{radio:"请选择一个选项",checkbox:"如果要继续，请选中此框",select:"请选择列表中的一项",email:"请输入电子邮件地址",url:"请输入网站地址",tel:"请输入手机号码",number:"请输入数值",date:"请输入日期",pattern:"内容格式不符合要求",empty:"请填写此字段",multiple:"多条数据使用逗号分隔"}};e.html5Attr=function(r,i){if(!r||!i)return t;if(document.querySelector){return e(r).attr(i)}else{var a;a=r.getAttributeNode(i);return a&&a.nodeValue!==""?a.nodeValue:t}};e.html5Validate=function(){return{isSupport:function(){return e('<input type="email">').attr("type")==="email"}(),isEmpty:function(t,r){r=r||e.html5Attr(t,"placeholder");var i=t.value;if(t.type!=="password"){i=e.trim(i)}if(i===""||i===r)return true;return false},isRegex:function(t,r,i){var a=t.value,n=a,s=t.getAttribute("type")+"";s=s.replace(/\W+$/,"");if(s!=="password"){n=e.trim(a);if(s!=="text"&&s!=="null"&&t.tagName.toLowerCase()!="textarea"){n=DBC2SBC(n)}if(n!==a)e(t).val(n)}r=r||function(){return e.html5Attr(t,"pattern")}()||function(){return s&&e.map(s.split("|"),function(e){var t=OBJREG[e.toUpperCase()];if(t)return t}).join("|")}();if(n===""||!r)return true;var o=e(t).hasProp("multiple"),l=new RegExp(r,i||"i");if(o&&!/^number|range$/i.test(s)){var d=true;e.each(n.split(","),function(t,r){r=e.trim(r);if(d&&!l.test(r)){d=false}});return d}else{return l.test(n)}return true},isOverflow:function(t){if(!t)return false;var r=e(t).attr("min"),i=e(t).attr("max"),a,n,s,o=t.value;if(!r&&!i){n=e(t).attr("data-min"),s=e(t).attr("data-max");if(n&&o.length<n){e(t).remindLayer("至少输入"+n+"个字符");t.focus()}else if(s&&o.length>s){e(t).remindLayer("最多输入"+s+"个字符");e(t).selectRange(s,o.length)}else{return false}}else{o=Number(o);a=Number(e(t).attr("step"))||1;if(r&&o<r){e(t).remindLayer("值必须大于或等于"+r)}else if(i&&o>i){e(t).remindLayer("值必须小于或等于"+i)}else if(a&&!/^\d+$/.test(Math.abs(o-r||0)/a)){e(t).remindLayer("值无效")}else{return false}t.focus();t.select()}return true},isAllpass:function(t,i){if(!t)return true;var a={labelDrive:true};params=e.extend({},a,i||{});if(t.size&&t.size()==1&&t.get(0).tagName.toLowerCase()=="form"){t=t.find(":input")}else if(t.tagName&&t.tagName.toLowerCase()=="form"){t=e(t).find(":input")}var n=this;var s=true,o=function(t,i,a){var n=e(t).attr("data-key"),s=e("label[for='"+t.id+"']"),o="",l;if(params.labelDrive){l=e.html5Attr(t,"placeholder");s.each(function(){var t=e(this).text();if(t!==l){o+=t.replace(/\*|:|：/g,"")}})}if(e(t).isVisible()){if(i=="radio"||i=="checkbox"){e(t).remindLayer(OBJREG.prompt[i],{align:"left"});t.focus()}else if(a=="select"||a=="empty"){e(t).remindLayer(a=="empty"&&o?"您尚未输入"+o:OBJREG.prompt[a]);t.focus()}else if(/^range|number$/i.test(i)&&Number(t.value)){e(t).remindLayer("值无效");t.focus();t.select()}else{var d=OBJREG.prompt[i]||OBJREG.prompt["pattern"];var u=e(t).attr("data-invalidmsg");if(o){d="您输入的"+o+"格式不准确"}if(i!="number"&&e(t).hasProp("multiple")){d+="，"+OBJREG.prompt["multiple"]}if(u)d+="</br>"+r.renderMsg(u);e(t).remindLayer(d);t.focus();t.select()}}else{var f=e(t).attr("data-target");var c=e("#"+f);if(c.size()==0){c=e("."+f)}var m="您尚未"+(n||(a=="empty"?"输入":"选择"))+(!/^radio|checkbox$/i.test(i)&&o||"该项内容");if(c.size()){if(c.offset().top<e(window).scrollTop()){e(window).scrollTop(c.offset().top-50)}c.remindLayer(m)}else{alert(m)}}return false};t.each(function(){var t=this,r=t.getAttribute("type"),i=t.tagName.toLowerCase(),a=e(this).hasProp("required");if(r){var l=r.replace(/\W+$/,"");if(!params.hasTypeNormally&&e.html5Validate.isSupport&&r!=l){try{t.type=l}catch(e){}}r=l}if(s==false||t.disabled||r=="submit"||r=="reset"||r=="file"||r=="image")return;if(r=="radio"&&a){var d=t.name?e("input[type='radio'][name='"+t.name+"']"):e(t),u=false;d.each(function(){if(u==false&&e(this).is(":checked")){u=true}});if(u==false){s=o(d.get(0),r,i)}}else if(r=="checkbox"&&a&&!e(t).is(":checked")){s=o(t,r,i)}else if(i=="select"&&a&&!t.value){s=o(t,r,i)}else if(a&&n.isEmpty(t)||!(s=n.isRegex(t))){s?o(t,r,"empty"):o(t,r,i);s=false}else if(n.isOverflow(t)){s=false}});return s}}}();e.fn.extend({isVisible:function(){return e(this).attr("type")!=="hidden"&&e(this).css("display")!=="none"&&e(this).css("visibility")!=="hidden"},hasProp:function(r){if(typeof r!=="string")return t;var i=false;if(document.querySelector){var a=e(this).attr(r);if(a!==t&&a!==false){i=true}}else{var n=e(this).get(0).outerHTML,s=n.slice(0,n.search(/\/?['"]?>(?![^<]*<['"])/));i=new RegExp("\\s"+r+"\\b","i").test(s)}return i},selectRange:function(t,r){var i=e(this).get(0);if(i.createTextRange){var a=i.createTextRange();a.collapse(true);a.moveEnd("character",r);a.moveStart("character",t);a.select()}else{i.focus();i.setSelectionRange(t,r)}return this},remindLayer:function(t,r){var i={size:6,align:"center",css:{maxWidth:280,backgroundColor:"#FFFFE0",borderColor:"#F7CE39",color:"#333",fontSize:"12px",padding:"5px 10px",zIndex:202}};r=r||{};r.css=e.extend({},i.css,r.css||e.remindLayer.css);var a=e.extend({},i,r||{});if(!t||!e(this).isVisible())return;var n={center:"50%",left:"15%",right:"85%"},s=n[a.align]||"50%";a.css.position="absolute";a.css.top="-99px";a.css.border="1px solid "+a.css.borderColor;if(e("#"+e.remindLayer.id).size())e.remindLayer.hide();this.remind=e('<div id="'+e.remindLayer.id+'">'+t+"</div>").css(a.css);e(document.body).append(this.remind);var o;if(!window.XMLHttpRequest&&(o=parseInt(a.css.maxWidth))&&this.remind.width()>o){this.remind.width(o)}var l=e(this).offset(),d="top";if(!l)return e(this);var u=l.top-this.remind.outerHeight()-a.size;if(u<e(document).scrollTop()){d="bottom";u=l.top+e(this).outerHeight()+a.size}var f=function(t){var r="transparent",i="dashed",n="solid";var s={},o={width:0,height:0,overflow:"hidden",borderWidth:a.size+"px",position:"absolute"},l={};if(t==="before"){s={top:{borderColor:[a.css.borderColor,r,r,r].join(" "),borderStyle:[n,i,i,i].join(" "),top:0},bottom:{borderColor:[r,r,a.css.borderColor,""].join(" "),borderStyle:[i,i,n,i].join(" "),bottom:0}}}else if(t==="after"){s={top:{borderColor:a.css.backgroundColor+["",r,r,r].join(" "),borderStyle:[n,i,i,i].join(" "),top:-1},bottom:{borderColor:[r,r,a.css.backgroundColor,""].join(" "),borderStyle:[i,i,n,i].join(" "),bottom:-1}}}else{s=null;o=null;l=null;return null}l=e.extend({},s[d],o);return e("<"+t+"></"+t+">").css(l)};var c={width:2*a.size,left:s,marginLeft:-1*a.size+"px",height:a.size,textIndent:0,overflow:"hidden",position:"absolute"};if(d=="top"){c["bottom"]=-1*a.size}else{c["top"]=-1*a.size}this.remind.css({left:l.left,top:u,marginLeft:e(this).outerWidth()*.5-this.remind.outerWidth()*parseInt(s)/100}).prepend(e("<div></div>").css(c).append(f("before")).append(f("after")));e.remindLayer.display=true;e.remindLayer.target=e(this).addClass("error");e.remindLayer.bind();return e(this)},html5Validate:function(t,r){var i={novalidate:true,submitEnabled:true,validate:function(){return true}};var a=e.extend({},i,r||{});var n=e(this).find(":input");if(e.html5Validate.isSupport){if(a.novalidate){e(this).attr("novalidate","novalidate")}else{n.each(function(){var e=this.getAttribute("type")+"",t=e.replace(/\W+$/,"");if(e!=t){try{this.type=t}catch(e){}}});a.hasTypeNormally=true}}if(a.submitEnabled){e(this).find(":disabled").each(function(){if(/^image|submit$/.test(this.type)){e(this).removeAttr("disabled")}})}e(this).bind("submit",function(r){r.preventDefault();if(e.html5Validate.isAllpass(n,a)&&a.validate()&&e.isFunction(t)){t.call(this)}return false});return e(this)}})})(require("jquery"));